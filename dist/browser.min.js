(()=>{var r=class n{#e;constructor(e){this.#e=n.collapse(e)}get value(){return this.#e}toString(){return this.#e}get length(){return this.#e.length}static collapse(e,t=""){if(e instanceof n)return e.value;if(typeof e!="string")throw new TypeError("path argument must be a string or an instance of Path");if(t&&!(t instanceof n)&&(t=new n(t)),e=e.trim(),e.length===0)return t.value;n.isRelative(e)&&(e=t+e);let s=n.reduce(e,(o,l)=>(l==".."?o.pop():l!=="."&&o.push(l),o),[]),i="/";return s.length&&(i+=s.join("/"),n.isFolder(e)&&(i+="/")),i}static isAbsolute(e){return e instanceof n?!0:e.length&&e[0]==="/"}static isRelative(e){return!n.isAbsolute(e)}static isFolder(e){return e instanceof n&&(e=e.value),e.length&&e[e.length-1]=="/"}static isPath(e){return e instanceof n?!0:typeof e!="string"?!1:(e=e.trim(),new URL(e,document.location).pathname==e)}static reduce(e,t,s){return e instanceof n&&(e=e.value),e.split("/").filter(Boolean).reduce(t,s)}static map(e,t){return e instanceof n&&(e=e.value),e.split("/").filter(Boolean).map(t)}static parent(e){e instanceof n&&(e=e.value),e=e.split("/").filter(Boolean),e.pop();let t="/";return e.length&&(t+=e.join("/")+"/"),t}static filename(e){return e instanceof n&&(e=e.value),e.split("/").filter(Boolean).pop()}static head(e){return e instanceof n&&(e=e.value),e.split("/").filter(Boolean).shift()}static tail(e){e instanceof n&&(e=e.value),e=e.split("/").filter(Boolean),e.shift();let t="/";return e.length&&(t+=e.join("/")+"/"),t}};var f=class n{#e;#t="/";constructor(e){this.#e=e,this.#t=this.#e.path}get path(){return this.#t}cd(e){return e instanceof r||(e=new r(r.collapse(e,this.#t))),new n(this.#e.cd(e))}async read(e,t=null){if(e instanceof r||(e=new r(r.collapse(e,this.#t))),typeof t=="function"){if(!this.#e.supportsStreamingRead())throw new Error("Adapter "+this.#e.name+" does not support streaming reading.");return this.#e.readStream(e,t)}else return this.#e.read(e)}async write(e,t,s=null){if(e instanceof r||(e=new r(r.collapse(e,this.#t))),!this.#e.supportsWrite())throw new Error("Adapter "+this.#e.name+" is read only.");if(typeof t=="function"){if(!this.#e.supportsStreamingWrite())throw new Error("Adapter "+this.#e.name+" does not support streaming writing.");return this.#e.writeStream(e,t,s)}else{if(typeof t=="string")return this.#e.write(e,t,s);throw new TypeError("Cannot write contents of type "+typeof t)}}async delete(e){return e instanceof r||(e=new r(r.collapse(e,this.#t))),this.#e.delete(e)}async exists(e){return e instanceof r||(e=new r(r.collapse(e,this.#t))),this.#e.exists(e)}async list(e=""){return e instanceof r||(e=new r(r.collapse(e,this.#t))),this.#e.list(e)}};var c=class n{#e;#t;#n;#r;constructor(e,t="/",s=null,i={}){this.#e=new URL(e,window.location.href),this.#t=new r(t),this.#n=s,this.#r=i}get name(){return"HttpAdapter"}get path(){return this.#t}supportsWrite(){return!0}supportsStreamingWrite(){return p}supportsStreamingRead(){return!0}cd(e){if(!r.isPath(e))throw new TypeError(e+" is not a valid path");return new n(this.#e.href,e)}async write(e,t,s=null){let i=Object.assign({},this.#r,{method:"PUT",body:t});return this.#s(e,i)}writeStream(e,t,s=null){throw new Error("Not yet implemented")}async read(e){let t=Object.assign({},this.#r,{method:"GET"}),s=await this.#s(e,t),i={type:this.#a(s),name:r.filename(e),http:{headers:s.headers,status:s.status,url:s.url}};return i.type.match(/text\/.*/)?i.contents=await s.text():i.type.match(/application\/json.*/)?i.contents=await s.json():i.contents=await s.blob(),i}readStream(e,t){throw new Error("Not yet implemented")}async exists(e){let t=Object.assign({},this.#r,{method:"HEAD"});return this.#s(e,t)}async delete(e){let t=Object.assign({},this.#r,{method:"DELETE"});return this.#s(e,t)}async list(e){let t=["text/html","text/xhtml","text/xhtml+xml","text/xml"],s=await this.read(e);if(t.includes(s.type.split(";")[0]))var i=s.contents;else{let a=this.#i(e);throw new TypeError("URL "+a+" is not of a supported content type",{cause:s})}let o=r.collapse(this.#e.pathname),l=this.#i(e),m=document.createElement("template");m.innerHTML=i;let d=m.content.querySelectorAll("a[href]");return Array.from(d).map(a=>{let u=new URL(a.getAttribute("href"),l.href);return a.href=u.href,{filename:r.filename(a.pathname),path:a.pathname,name:a.innerText,href:a.href}}).filter(a=>{let u=new URL(a.href);return u.pathname=r.parent(u.pathname),u.href===l.href}).map(a=>({filename:a.filename,path:a.path.substring(o.length-1),name:a.name}))}#i(e){return e=r.collapse(this.#e.pathname+r.collapse(e)),new URL(e,this.#e)}async#s(e,t){return fetch(this.#i(e),t).catch(s=>{if(!this.#n||!this.#n(url,t,s))throw s})}#a(e){return e.headers.has("Content-Type")?e.headers.get("Content-Type"):null}},p=(async()=>new Request("",{body:new ReadableStream,method:"POST",duplex:"half"}).headers.has("Content-Type")?!1:fetch("data:a/a;charset=utf-8,",{method:"POST",body:new ReadableStream,duplex:"half"}).then(()=>!0,()=>!1))();var h={fs:f,adapters:{https:c},path:r};window.jsfs=h;var E=h;})();
//# sourceMappingURL=browser.min.js.map
